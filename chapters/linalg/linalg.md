# Линейная алгебра

## Введение

Линейная алгебра --- относительно недавнее изобретение. Первые работы в области механики были лишены этого полезного инструмента, обычно записывали системы похожих уравнений, что-то суммировали и умножали, всё это выглядело очень печально и громоздко.

Позже векторная алгебра распространилась на все сферы физики, например закон Био-Савара-Лапласа, описывающий структуру магнитного поля, получил имя Лапласа ровно потому, что он помог физикам-экспериментаторам удобно выразить выявленные зависимости (Лаплас был закоренелый математик и от физики был далёк).

Данная глава призвана построить ясную картинку того, что такое линейная алгебра на базовом уровне. Отдельно рассматривается применение линейной алгебры в механике, в особенности тех её частях, которые будут полезны в контексте школьного курса астрономии.

Первая часть --- 'Алгебраические структуры' демонстрирует некоторую абстрактную картинку, поясняющую смысл векторов в отрыве от геометрической интерпретации. Вероятно, освоить её будет не слишком простым занятием, однако авторы надеются, что это доставит читателю некоторое удовольствие. Эта глава написана на основе классического учебника алгебры авторства Винберга Э. Б., когда-то прочитавшего курс лекций по алгебре в НМУ. В главе с самых основ вводятся определения основных понятий алгебры, объясняется их внутреннее устройство. Авторы надеются, что читатель сможет построить взаимосвязи между различными областями математики, с которыми он уже знаком из курса школьной математики.

Вторая часть --- 'Аналитическая геометрия', её основная задача состоит в том, чтобы связать построенное определение векторов с геометрией. Вводятся такие важные понятия, как скалярное и векторное произведение, линейный оператор. Задачи и примеры могут быть полезны в решении задач в сфере астрономии: отдельно уделено внимание сферической тригонометрии, сферическим координатам и смежным вопросам. Глава составлена с учётом опыта преподавания школьной олимпиадной физики на Физтехе.

Третья часть --- 'Избранные примеры применения векторной алгебры', содержит в себе конкретные сюжеты из механики и других сфер физики, эксплуатируемые на олимпиадах по астрономии, приводятся конкретные задачи, попадавшие в комплекты прошлых лет, либо касающиеся частовстречающихся олимпиадных механик.

Авторы желают читателю продуктивно поработать, надеются, что этот текст поможет лучше понять и научиться применять линейную алгебру в своей практике.

## Алгебраические структуры

```{admonition} Определение
Операцией на множестве $M$ называют отображение вида:

$$
M\times M\to M.
$$
```
:::{admonition} Пример
:class: note

Операция умножения на множестве целых чисел $\mathbb Z$ по сути --- некоторая функция, которая cъедает два целых числа, преобразует их согласно таблице умножения, и на выходе получается третье целое число: $5\cdot3=15$.
:::
```{admonition} Определение
Множества с определёнными на них операциями называют алгебраическими структурами.
```

То есть пара $(\mathbb Z, \cdot)$ является алгебраической структурой. Пара $(\mathbb Z, +)$ --- тоже алгебраическая структура, причём отличная от предыдущей.

Пусть определены отображения:

$$
f:N\to M,\;\;\; g:P\to N.
$$

```{admonition} Определение
Тогда композицией таких двух отображений называют отображение:

$$
fg:P\to M,\;\;\; fg(x)=f(g(x))\forall x\in P.
$$
```
:::{admonition} Пример
:class: note
$e^{x+4}$: сначала выполняется сложение ($g(x)=x+4$), затем возведение в степень ($f(x)=e^x$).
:::
```{admonition} Определение
Алгебраические структуры $(M,\circ)$ и $(N, *)$ называют изоморфными, если существует такое биективное отображение $f: M\to N$, что

$$
f(a\circ b)=f(a)*f(b), \;\;\; \forall a, b\in M.
$$
```
:::{admonition} Пример
:class: note
Рассмотрим алгебраические структуры $(\mathbb{R}, +)$ и $(\mathbb{R}^+, \cdot)$. $e^x$ --- естественный изоморфизм для этих структур: $e^a\cdot e^b=e^{a+b}$.
:::
:::{admonition} Задача
:class: tip
а) Найдите изоморфизм для $(\mathbb{Z}^+, +)$ и $(\mathbb{Z}^-, +)$. б) Покажите изоморфизм между множеством значений времени на электронных часах и множеством остатков от деления некоторого целого числа (какого?, какие операции на множествах следует ввести?).
:::

Рассмотрим теперь некоторые специальные классы операций, заданные сериями аксиом:

$$
A1) a+b=b+a, \;\; A2) (a+b)+c=a+(b+c), \;\; A3) a+0=a, \;\; A4) a+(-a)=0.
$$

$$
M1) ab=ba, \;\; M2) (ab)c=a(bc), \;\; M3) a1=a, \;\; M4) aa^{-1}=1\;\text{если} a\neq 0.
$$

```{admonition} Определение
Алгебраические структуры, удовлетворяющие первому набору аксиом, называют аддитивными абелевыми группами, а второму, соответсвенно, мультипликативными абелевыми группами.
```

Авторы сознательно отступили от традиционного определения коммутативной группы, не кидайте в нас тапками. В традиционной версии не допускается существование единственного необратимого элемента, как это сделано в определении мультипликативной абелевой группы, однако его существование отдельно оговаривается в определении поля.

В литеретуре допусается опускать слово абелева в определении группы, так авторы и поступают далее. По сути предложено определение коммутативной группы (в обоих случаях, с учетом первого комментария). Если исключить из аксиом коммутативность, получится просто группа.

:::{admonition} Задача
:class: tip
а) Являются ли движения плоскости группой? б) Являются ли повороты плоскости группой?
:::
:::{admonition} Задача
:class: tip
Рассмотрим все подмножества непустого множества $X$. Являются ли они группой относительно объединения? пересечения?
:::
```{admonition} Определение
Полем называют множество с двумя операциями на нём (сложением и умножением). Требуют, чтобы множество было аддитивной абелевой группой относительно сложения с нейтральным элементом $0$, мультипликативной абелевой группой относительно умножения с нейтральным элементом $1$. Также требуется дистрибутивность:

$$
(a+b)c=ac+bc.
$$

```
:::{admonition} Пример
:class: note
Поле действительных чисел $(\mathbb R, +, \cdot)$.
:::
:::{admonition} Задача
:class: tip
Является ли множество целых числел $\mathbb Z$ полем? а рациональных $\mathbb Q$?
:::

В элементарной геометрии определяют векторы. Их свойства во многом отвечают свойствам элементов алгебраического поля, однако повторяют их не в полной мере. Для работы с векторами вводят особый класс множеств: векторные пространства.

```{admonition} Определение
Векторным пространством над полем $\mathbb F$ называют множество $\mathbb V$ с операциями сложения и умножения на элементы поля $\mathbb F$, удовлетворяющее следующим аксиомам:
```

$$
V1) \mathbb V -\text{аддитивная абелева группа относительно сложения},
$$

$$
V2) \lambda(a+b)=\lambda a+\lambda b, \;\; V3) (\lambda +\mu)a=\lambda a +\mu a, \;\; V4) (\lambda\mu)a=\lambda(\mu a), \;\; V5) 1a=a
$$

$$
\forall a,b\in\mathbb V, \;\; \forall\lambda,\mu\in\mathbb F .
$$

:::{admonition} Задача
:class: tip
Какие из следующих пространств над $\mathbb R$ являются векторными? $\mathbb R$, $\mathbb C$, полиномов степени $\leq n$, всех функций таких, что $f(1)=0$, всех функций таких, что $f(1)=1$.
:::

Иногда требуется усиление определения векторного пространства, называемое алгеброй.

```{admonition} Определение
Пусть $\mathbb A$ --- векторное пространство над $\mathbb F$, снабженное операцией умножения $\mathbb A\times\mathbb A\to\mathbb A$. Тогда, если выполняются дополнительные аксиомы,  $\mathbb A$ --- алгебра:
```

$$
A1) (a+b)\cdot c = a\cdot c+b\cdot c, \;\; A2) a\cdot(b+c) = a\cdot b+a\cdot c, \;\; A3) (\lambda a)\cdot(\mu b) = \lambda\mu(a\cdot b).
$$

Иногда эти три дополнительные аксиомы называют требованием билинейности для операции $\cdot$. Обратите внимание, множители в общем случае нельзя переставлять местами!

:::{admonition} Пример
:class: note
Поле $\mathbb C$ как алгебра над $\mathbb R$ задаётся таблицей умножения единиц:
|$\times$|$1$|$i$|
|---|---|---|
|$1$|$1$|$i$|
|$i$|$i$|$-1$|
:::

Этой таблицы умножения достаточно для определения поля $\mathbb C$, нужно лишь проверить коммутативность и ассоциативность умножения для $1, i$.

Одним из важнейших примеров алгебры является алгебра матриц, широко применяемая в линейной алгебре, аналитической геометрии, анализе данных, теории поля.

```{admonition} Определение
Матрицей размера $m\times n$ над полем $\mathbb F$ называется прямоугольная таблица из элементов $\mathbb F$, имеющая $m$ строк и $n$ столбцов.
```

$$
A=\begin{pmatrix}
    a_{11}&a_{12}&\cdots&a_{1n}\\
    a_{21}&a_{22}&\cdots&a_{2n}\\
    \cdots&\cdots&\cdots&\cdots\\
    a_{m1}&a_{m2}&\cdots&a_{mn}\\
\end{pmatrix}=a_{ij}
$$

Введём опреацию сложения для матриц одинакового размера:

$$
A+B = a_{ij}+b_{ij}.
$$

То есть имеется в виду почленное сложение. Также для матриц вводится операция умножения на скаляр:

$$
\lambda A = \lambda a_{ij}.
$$

Относительно двух этих операций все матрицы конкретного размера образуют векторное пространство.

:::{admonition} Пример
:class: note

$$
5\begin{pmatrix}
        2\\
        0\\
        1\\
    \end{pmatrix}+\begin{pmatrix}
            1\\
            3\\
            4\\
        \end{pmatrix}=\begin{pmatrix}
                11\\
                3\\
                9\\
            \end{pmatrix}
$$
:::

Для двух матриц размеров $m\times n$ и $n\times p$ определяют операцию матричного умножения:

$$
C=A\times B, \;\; c_{ik} = \sum\limits_{j=1}^na_{ij}b_{jk}.
$$

Удобно пользоваться не формальным определением, а освоить какую-нибудь мнемоническую технику.

:::{admonition} Пример
:class: note

$$
A=
    \begin{pmatrix}
        1&0&2\\
        0&-1&3\\
    \end{pmatrix}
        \begin{pmatrix}
            2&-1\\
            0&5\\
            1&1\\
        \end{pmatrix}
        =
            \begin{pmatrix}
                1\cdot 2+0\cdot 0+2\cdot 1&1\cdot (-1)+0\cdot 5+2\cdot 1\\
                0\cdot 2+(-1)\cdot 0+3\cdot 1&0\cdot (-1)+(-1)\cdot 5+3\cdot 1\\
            \end{pmatrix}=
                \begin{pmatrix}
                    4&1\\
                    3&-2\\
                \end{pmatrix}
    
$$

:::

Умножение матриц ассоциативно: $(AB)C=A(BC)$, но не коммутативно (перестановка порядка недопустима в общем случае). Выполняются также следующие свойства:

$$
A(B+C) = AB+AC, \;\; (A+B)C=AC+BC, \;\; (\lambda A)B=A(\lambda B)=\lambda AB.
$$

:::{admonition} Задача
:class: tip
Как выглядит единичная матрица для алгебры квадратных матриц $2\times 2$?
:::
:::{admonition} Задача
:class: tip
Приведите пример двух матриц, покажите, что перестановка множителей меняет результат.
:::
:::{admonition} Задача
:class: tip
Приведите пример двух матриц, произведение которых равно нулевой матрице.
:::
:::{admonition} Задача
:class: tip
Приведите пример двух матриц, произведение которых равно $E$.
:::

## Аналитическая геометрия

В этом разделе мы поговорим подробнее о структуре векторного пространства и введём специальные операции для его элементов. Среди прочего вашему вниманию будет предложена содержательная иллюстрация возможностей аналитической геометрии.

Чтобы описать векторы в пространстве вы уже пользовались некоторой координатной формой записи, вероятно вам даже знакомо понятие базисных векторов. Поговорим об этом подробнее.

```{admonition} Определение
Множество векторов называют линейно независимым, если ни одна нетривиальная линейная комбинация $\lambda_1a+\lambda_2b+\lambda_3c\cdots,\;\; a, b, c\in\mathbb V, \lambda\in\mathbb R$ не равна нулю.
```
```{admonition} Определение
Базисом векторного пространства $\mathbb V$ называют линейно независимый упорядоченный набор векторов,такой, что любой вектор из $\mathbb V$ можно представить, как линейную комбинацию векторов из этого набора.
```
:::{admonition} Задача
:class: tip
Сколько векторов содержит любой базис пространства векторов на плоскости? В трёхмерном пространстве?
:::
:::{admonition} Задача
:class: tip
Покажите, что коллинеарные векторы линейно зависимы. Покажите, что любые три вектора на плоскости линейно зависимы. Покажите, что любые два неколлинеарных вектора образуют базис на плоскости.
:::
:::{admonition} Задача
:class: tip
Рассмотрим векторное пространство двумерных геометрических векторов. Векторы $a, b, c, d$ ориентированы относительно оси $X$ под углами $0^\circ, 45^\circ, 90^\circ, 180^\circ$ и имеют длины $2, 1, 3, 1$. Образуют ли базис пары $a, c; b,d; a, d$? Найдите разложения вектора $b$ по каждому из этих базисов. Выразите эти разложения в матричной форме.
:::

Как работает матричная запись векторов: пусть есть базис $e_1, e_2$. Пусть вектор представляется как линейная комбинация веторов базиса: $a=3e_1+4e_2$. Тогда матричная запись для $a$ выглядит так: $\begin{pmatrix}
        3\\
        4\\
    \end{pmatrix}$.

:::{admonition} Задача
:class: tip
Как выглядит матричная запись для $e_1, e_2$ из рассуждения выше?
:::
:::{admonition} Пример
:class: note
Следующий набор векторов:

$$
    \begin{pmatrix}
        3\\
        4\\
    \end{pmatrix}
    ,
        \begin{pmatrix}
            7\\
            1\\
        \end{pmatrix}
        ,
            \begin{pmatrix}
                6\\
                8\\
            \end{pmatrix}
            
$$

является линейно зависимым, поскольку:

$$
2
    \begin{pmatrix}
        3\\
        4\\
    \end{pmatrix}
    + 0
        \begin{pmatrix}
            7\\
            1\\
        \end{pmatrix}
        - 1
            \begin{pmatrix}
                6\\
                8\\
            \end{pmatrix}
            =
                \begin{pmatrix}
                    0\\
                    0\\
                \end{pmatrix}
                .
$$

:::

На самом деле вопросы о линейной зависимости имеют тесную связь с решением систем линейных уравнений, так для этих векторов можно было бы рассмотреть такую систему:

$$
\begin{cases}
3x+7y+6z=0\\
4x+1y+8z=0\\
\end{cases}
$$

Понятно, что у такой системы бесконечно много решений, $x=2, y=0, z=-1$ --- лишь одно из них.

Поговорим теперь о некоторых специальных функциях для векторов. Одна из самых главных --- скалярное произведение.

```{admonition} Определение
Скалярным произведением называют функцию $\mathbb V\times\mathbb V\to\mathbb R$ на векторном пространстве, удовлетворяющую аксиомам:
```

$$
S1)(a, b+c) = (a,b)+(a,c), \;\; S2) (a, \lambda b)=\lambda (a,b), \;\; S3) (a,b)=(b,a), \;\; S4) (a,a)>0\;\text{при}\;a\neq0,\;(0,0)=0.
$$

В классической геометрии скалярное произведение определяют так: $(a,b)=|a||b|\cos\alpha$. В координатной форме это выглядит так: $(a,b)=a_xb_x+a_yb_y$ (в трёхмерном случае аналогично).

:::{admonition} Задача
:class: tip
Проверьте, что предложенные функции удовлетворяют аксиомам.
:::
:::{admonition} Задача
:class: tip
Как проверить ортогональность векторов, зная их координаты?
:::
:::{admonition} Задача
:class: tip
Как выразить длину вектора через скалярное произведение?
:::
:::{admonition} Пример
:class: note
Пользуясь результатом предыдущих задач можно показать, как из определения скалярного произведения возникает его координатная форма записи:

$$
(a,b)=(a_xe_1+a_ye_2, b_xe_1+b_ye_2)=a_xb_x(e_1,e_1)+a_xb_y(e_1,e_2)+a_yb_x(e_2,e_1)+a_yb_y(e_2,e_2).
$$

$$
(a,b)=a_xb_x+a_yb_y.
$$

:::

Произошло следующее: скалярные произведения, содержавшие разные базисные векторы, обратились в нуль, поскольку они перпендикулярны. Оставшиеся скалярные произведения обратились в единицы, поскольку в обычном евклидовом пространстве, для которого верна упомянутая координатная запись, базисные векторы нормированы (их длина --- $1$).

:::{admonition} Задача
:class: tip
Зададим в пространстве плосксть: $5x+4y-z=0$. Какие координаты имеет вектор нормали к этой плоскости? ($XYZ$ --- обычная прямоугольная система отсчета.) Как изменится ответ, если ввести в уравнение свободный член: $5x+4y-z+7=0$?
:::

Ещё одной важной функцией является векторное произведение векторов.

```{admonition} Определение
Векторным произведением называют операцию на векторном пространстве $\mathbb V\times\mathbb V\to\mathbb V$, удовлетворяющее следующим условиям: 1) пусть $[a,b]=c$, тогда $|c|=|a||b|\sin\alpha$, 2) $(a,c)=(b,c)=0$, 3) тройка векторов $a,b,c$ --- правая.
```
:::{admonition} Задача
:class: tip
Векторное произведение каких векторов равно нулю?
:::
:::{admonition} Задача
:class: tip
Известно, что $a=[b,c], b=[c,a], c=[a,b]$. Найдите длины $a,b,c$ и углы между ними.
:::

В координатах выражение для векторного произведения выглядит так:

$$
c_x=a_yb_z-a_zb_y,\;\;c_y=-(a_xb_z-a_zb_x), \;\; c_z=a_xb_y-a_yb_x.
$$

:::{admonition} Задача
:class: tip
Пусть заданы две плоскости: $ax+by+cz=0, dx+ey+fz=0$. Найдите вектор, параллельный прямой их пересечения.
:::

Далее хочется продемонстрировать возможности векторного аппарата на знакомом вам примере: выведем сферическую теорему косинусов.

Рассмотрим сферу с $R=1$. Выберем на ней три точки: $A,B,C$, которым соответствуют радиус-векторы $\bar a,\bar b,\bar c$. Угловую меру сторон треугольника обозначим как $a,b,c$, углы треугольника обозначим как $A,B,C$. Можно выписать скалярные произведения радиус-векторов:

$$
(\bar a,\bar b)=R^2\cos c=\cos c
$$

$$
(\bar a,\bar c)=R^2\cos b=\cos b
$$

$$
(\bar b,\bar c)=R^2\cos a=\cos a
$$

Распишем теперь следующее скалярное произведение (подумайте, какой у него смысл?):

$$
([\bar a,\bar b],[\bar a,\bar c])=(|\bar a||\bar b|\sin c)(|\bar a||\bar c|\sin b)\cos A=\sin b\sin c\cos A.
$$

С другой стороны можно воспользоваться свойствами скалярного и векторного произведений и сделать следующие преобразования:

$$
([\bar a,\bar b],[\bar a,\bar c]) = (\bar a, [\bar b, [\bar a,\bar c]])=(\bar a, \{\bar a(\bar b,\bar c)-\bar c(\bar a,\bar b)\})=(\bar b,\bar c)-(\bar a,\bar c)(\bar a,\bar b)=\cos a-\cos c\cos b
$$

Приравниваем два результата, получаем интересующую нас формулу:

$$
\cos a = \cos b\cos c+\sin b\sin c\cos A.
$$

Сильно более простая конструкция, но не менее важная: переход между декартовыми и сферическими координатами. В случае обычных земных координат переход выглядит так:

$$
    \begin{pmatrix}
        x\\
        y\\
        z\\
    \end{pmatrix}
    =R
    \begin{pmatrix}
        \cos\varphi\cos\lambda\\
        \cos\varphi\sin\lambda\\
        \sin\varphi\\
    \end{pmatrix}
    
$$

:::{admonition} Задача
:class: tip
Предложите обратное преобразование: из декартовых координат в сферические.
:::
:::{admonition} Задача
:class: tip
Пользуясь предложенным преобразованием, получите уравнение плоскости математического горизонта для наблюдателя с координатами $(\varphi,\lambda)$. Свободным членом пренебречь.
:::
:::{admonition} Задача
:class: tip
В точках со сферическими координатами $(\varphi_1,\lambda_1)$ и $(\varphi_2,\lambda_2)$ находятся полюса двух различных больших кругов сферы. Найдите координаты точек пересечения кругов.
:::
:::{admonition} Задача
:class: tip
Найдите расстояние между земными наблюдателями с координатами $(\varphi_1,\lambda_1)$ и $(\varphi_2,\lambda_2)$.
:::

В последнем примере по сути построен некое биективное (почти) отображение между прямоугольными и криволинейными координатами. Такие конструкции не всегда столь удобны, как хотелось бы. Если бы мы строили переход между двумя прямоугольными системами (в чуть более общем случае --- между векторными простраанствами), это можно было бы красиво и приятно сделать с помощью матричного аппарата. О таких случаях хочется поговорить подробнее.

Обычно хорошие отображения между векторными пространствами называют линейными операторами.

```{admonition} Определение
Линейный оператор --- отображение $\mathbb V\to\mathbb V$ такое, что $1) A(a+b)=A(a)+A(b),\;\;2) A(\lambda a)=\lambda A(a)$.
```

Обычнно линейные операторы представляют в матричной форме:

$$
b=Aa
$$

При этом операция выполняется по правилам матричной алгебры, так, как она была введена ранее. Линейные операторы позволяют изменять векторы, например, скалярные матрицы сжимают и растягивают векторы, не меняя направления:

$$
    \begin{pmatrix}
        6\\
        14\\
    \end{pmatrix}
    =
    \begin{pmatrix}
        2&0\\
        0&2\\
    \end{pmatrix}
    \begin{pmatrix}
        3\\
        7\\
    \end{pmatrix}
$$

Матрицы следующего вида:

$$
    \begin{pmatrix}
        \cos\alpha&-\sin\alpha\\
        \sin\alpha&\cos\alpha\\
    \end{pmatrix}
$$

Поворачивают векторы на угол $\alpha$, не меняя длины. Последовательное применение двух линейных операторов (композиция) также может быть вычислено как произведение двух матриц.

:::{admonition} Пример
:class: note
Сперва развернём вектор, а потом повернём его на $90^\circ$:

$$

    \begin{pmatrix}
        \cos 90^\circ&-\sin 90^\circ\\
        \sin 90^\circ&\cos 90^\circ\\
    \end{pmatrix}
        \begin{pmatrix}
            -1&0\\
            0&-1\\
        \end{pmatrix}
            \begin{pmatrix}
                x\\
                y\\
            \end{pmatrix}
            =
            \begin{pmatrix}
                0&1\\
                -1&0\\
            \end{pmatrix}
            
                \begin{pmatrix}
                    x\\
                    y\\
                \end{pmatrix}
                =
                    \begin{pmatrix}
                        y\\
                        -x\\
                    \end{pmatrix}
                    
$$

:::
:::{admonition} Задача
:class: tip
Какой линейный оператор возвращает обратный по сложению вектор? $A(a)=-a$.
:::
:::{admonition} Задача
:class: tip
Покажите, что оператор поворота не меняет длину вектора.
:::
:::{admonition} Задача
:class: tip
Являются ли следующие отображения линейными операторами?

$$
A
    \begin{pmatrix}
        x\\
        y\\
    \end{pmatrix}
    =0, \;\;B
        \begin{pmatrix}
            x\\
            y\\
        \end{pmatrix}
        =
            \begin{pmatrix}
                x+1\\
                y+1\\
            \end{pmatrix}
            ,\;\;C
                \begin{pmatrix}
                    x\\
                    y\\
                \end{pmatrix}
                =
                    \begin{pmatrix}
                        x\\
                        -y\\
                    \end{pmatrix}
                    , \;\;D
                        \begin{pmatrix}
                            x\\
                            y\\
                        \end{pmatrix}
                        =
                            \begin{pmatrix}
                                x+y\\
                                xy\\
                            \end{pmatrix}
                            .
$$
:::
:::{admonition} Задача
:class: tip
Как выглядит матрица поворота вокруг оси $Z$ в трёхмерном пространстве?
:::
:::{admonition} Задача
:class: tip
Предложите матрицу, удовлетворяющую условию: $A^n=E$ для натуральных $n$.
:::
:::{admonition} Задача
:class: tip
Вычислите:

$$
                        \begin{pmatrix}
                            1&1\\
                            1&1\\
                        \end{pmatrix}^n, \;\;
                        
                        \begin{pmatrix}
                            1&1&1\\
                            0&0&0\\
                            0&0&0\\
                        \end{pmatrix}
                        ^n,\;\;
                        
                        \begin{pmatrix}
                            0&1&0\\
                            0&0&1\\
                            0&0&0\\
                        \end{pmatrix}
                        ^n.
$$
:::

## Избранные примеры применения векторной алгебры

В этом разделе хочется поговорить о применении векторного аппарата в задачах физики.

### Кинематика

Одним из важнейших понятий в кинематике является угловая скорость. В школьном курсе её принято считать скалярной величиной, что может быть не вполне удобно. Так, выражение для скорости на окружности записывают следующим образом:

$$
v=\omega r,
$$

где $v$ --- скорость тела, $r$ --- радиус окружности, $\omega$ --- угловая скорость. Обычно угловую скорость также связывают с частотой периодического процесса (поэтому $\omega$ встречается не только в механике): $\omega/2\pi=\nu$.

Проблема с таким определением $\omega$ в том, что нет никакой информации об ориентации вращения:

```{admonition} Теорема
У тела, вращающегося в трёхмерном пространстве с постоянной угловой скоростью, существует единственная ось вращения, точки тела на ней не имеют вращательной компоненты движения.
```

Давайте определим вектор угловой скорости $\bar\omega$ как вектор, параллельный оси вращения, по модулю равный $\omega$ в ранее предложенном смысле. Направление $\omega$ определяют по правилу правого буравчика.

У такого определения угловой скорости есть несколько замечательных свойств. Наример, аддитивность: если есть два вращательных движения, то их можно складывать:

$$
\bar\omega_1+\bar\omega_2=\bar\omega.
$$

Выражение для скорости имеет вид:

$$
\bar v = [\bar\omega,\bar r].
$$

Здесь $\bar r$ --- радиус-вектор тела. То есть изначально записанная формула является лишь частным случаем более красивого закона.

:::{admonition} Задача
:class: tip
Спутник находится на круговой полярной орбите с высотой $500$ км. На спутнике установлен лазер, направленный вертикально вниз. Какова скорость светового пятна относительно наблюдателя, стоящего на поверхности?
:::
:::{admonition} Задача
:class: tip
В северном полушарии Земли установлен телескоп с одноосным часовым
механизмом, имеющим специальный режим для гидирования Луны. В этом режиме угловая
скорость вращения телескопа вокруг оси отличается от угловой скорости осевого вращения
Земли, а сама ось перед непосредственными наблюдениями отклоняется от Северного
полюса мира в точку неба с некоторыми экваториальными координатами, фиксированными
для этого режима. Найдите эти координаты проекции оси на небе $(\alpha,\delta)$ и угловую скорость вращения телескопа, которые обеспечат наилучшую точность ведения для
любого положения Луны на небе и орбите. Считать орбиту Луны круговой и лежащей в
плоскости эклиптики, эффектами суточного параллакса Луны и рефракцией пренебречь. (задача с всероса 11 класса 2022 года)
:::

### Динамика

Вероятно, вам неоднократно приходилось видеть выводы различных утверждений (законы Кеплера, поле диполя, равновесие сил) с применением векторной алгебры. Часто векторы маскируют бесконечными проекциями, что, конечно имеет смысл, но скрывает за собой определённую красоту. Самое содержательное действие в подобных задачах, предшествующее механической вычислительной работе --- запись неких векторных функций:

$$
\bar F(\bar r), \;\; \bar p(t), \;\; ...
$$

Здесь мы покажем получение точек Лагранжа $L_4, L_5$, философия которого отличается от стандартного подхода в динамике.

Рассмотрим систему из двух точечых масс $M_1, M_2$, центр отсчёта поместим в центр масс системы. $\bar r_1, \bar r_2, \bar r$ --- радиус-векторы $M_1, M_2$ и пробной массы. Через $\omega$ обозначим угловую скорость Земли. Составим баланс сил:

$$
\frac{GM_1}{|\bar r-\bar r_1|^3}(\bar r-\bar r_1)+\frac{GM_2}{|\bar r-\bar r_2|^3}(\bar r-\bar r_2)=\omega^2\bar r.
$$

Можно заменить это выражение на уравнение следующего вида (силы можно предстваить как некие скалярные коэффициенты, умноженные на векторы-направления):

$$
\alpha (\bar r-\bar r_1)+\beta(\bar r-\bar r_2)=\bar r, \;\; \alpha,\beta\in\mathbb R.
$$

Здесь $\alpha$ и $\beta$ зависят от $\bar r$ через длины векторов: $|\bar r-\bar r_1|$ и $|\bar r-\bar r_2|$. Смысл уравнения в том, что силы направленные по векторам от масс к пробной массе в сумме дают силу, направленную коллинеарно радиус-вектору пробной массы. Следующий шаг очевиден:

$$
\alpha\bar r_1+\beta\bar r_2=(\alpha+\beta-1)\bar r.
$$

Это значит, что левая сумма даёт вектор, коллинеарный $\bar r$. Если мы хотим найти $\bar r$, не коллинеарный ни $\bar r_1$, ни $\bar r_2$, это значит, что

$$
\alpha\bar r_1+\beta\bar r_2 = 0.
$$

Вспомним также, что векторы по изначальной договорённсти отсчитываем от центра масс, это значит, что

$$
M_1\bar r_1+M_2\bar r_2=0.
$$

Откуда следует, что должно выполниться соотношение:

$$
\alpha:\beta=M_1:M_2.
$$

Вспомним первое уравнение и выпишем точные значения для $\alpha$ и $\beta$:

$$
\alpha = \frac{GM_1}{\omega^2|\bar r-\bar r_1|^3}, \;\; \beta = \frac{GM_2}{\omega^2|\bar r-\bar r_2|^3}.
$$

Отношение $\alpha$ и $\beta$ равно отношению масс только если $|\bar r-\bar r_1|=|\bar r-\bar r_2|$. Обозначим это расстояние как $s$. Кроме того распишем угловую скорость $\omega$ с помощью третьего закона Кеплера:

$$
\omega^2 = \frac{G(M_1+M_2)}{|\bar r_1-\bar r_2|^3}.
$$

Тогда самое первое выражение примет вид:

$$
\frac{GM_1}{s^3}(\bar r-\bar r_1)+\frac{GM_2}{s^3}(\bar r-\bar r_2)=\frac{G(M_1+M_2)}{|\bar r_1-\bar r_2|^3}\bar r.
$$

Уравнение легко решается, если снова вспомнить соотношение между $\bar r_1$, $\bar r_2$: $M_1\bar r_1+M_2\bar r_2=0$. Тогда очевидно, что $|\bar r_1-\bar r_2|=s$. Это означает, что точки $L_4, L_5$ находятся на равном расстоянии от обоих масс, причем это расстояние равно расстоянию между массами.

:::{admonition} Задача
:class: tip
Три звезды массы $M$ находятся на равном расстоянии $a$ друг от друга и вращаются по круговым орбитам. Найдите период их обращения.
:::
:::{admonition} Задача
:class: tip
Найдите в векторном виде выражение для поля гравитационного диполя, заданного вектором $\bar l$, на концах которого жестко закреплены две равные массы $m$.
:::

### Оптика

Конечно, весьма мала вероятность, что в школе придётся решать задачу с применением техники матричной оптики (если вы не пишете кубок ЛФИ), однако авторы думают, что читатель найдёт эту небольшую зарисовку занимательной.

Положим, в оптическую систему входит луч. Когда он проходит через некоторую нулевую плоскость, можно определить его высоту $h$ от главной оптической оси и угол к этой оси $\alpha$. Этой информации достаточно для дальнейшей работы, организуем вектор, в котором она будет храниться: $
    \begin{pmatrix}
        h\\
        \alpha\\
    \end{pmatrix}$. Каждый оптический элемент в устройстве, которое мы попробуем смоделировать, будет как-то изменять луч, попробуем записать эти преобразования как линейные операторы (матрицы).

Самым простым элементом оптических схем является пустота, как она действует на луч? 1) она не меняет угол падения света, 2) изменится высота луча, величина изменения зависит от угла падения. В приближении малых углов, если луч прошел расстояние $d$, то он поднимется (точка проходения лучом плоскости, перпендикулярной галвной оптической оси) на $d\alpha$. Тогда легко записать матрицу такого преобразования:

$$
    
    \begin{pmatrix}
        h'\\
        \alpha'\\
    \end{pmatrix}
    =
        \begin{pmatrix}
            1&d\\
            0&1\\
        \end{pmatrix}
        
            \begin{pmatrix}
                h\\
                \alpha\\
            \end{pmatrix}     .
    $$

То есть, $h'=h+d\alpha$, а $\alpha'=\alpha$, как и требовалось.

Похожие рассуждения позволяют найти оператор для тонкой собирающей линзы: здесь нет разницы между начальной и конечной плоскостью, поскольку линза тонкая, это значит, что $h$ не меняется, луч только преломляется. Если $h=0$, то луч проходит через центр линзы, а значит, что $\alpha$ не должен поменяться. Если $\alpha=0$, то $\alpha'$ зависит от $h$: $\alpha'=-\frac{h}{F}$, где $F$ --- фокусное расстояние. Эти граничные условия позволяют получить следующий линеный оператор для тонкой линзы:

$$
    
    \begin{pmatrix}
        h'\\
        \alpha'\\
    \end{pmatrix}
    =
        \begin{pmatrix}
            1&0\\
            -\frac{1}{F}&1\\
        \end{pmatrix}
        
            \begin{pmatrix}
                h\\
                \alpha\\
            \end{pmatrix}
            .
    $$

Несложно проверить, что указанные выше условия выполняются. Ещё один оптический элемент --- плоское зеркало. Здесь всё совсем просто: $h$ не меняется в процессе отражения, $\alpha$ --- тоже, поскольку угол падения равен углу отражения (фактическая ориентация, конечно изменится, но сам угол к оптической оси останется прежним):

$$
    
    \begin{pmatrix}
        h'\\
        \alpha'\\
    \end{pmatrix}
    =
        \begin{pmatrix}
            1&0\\
            0&1\\
        \end{pmatrix}
        
            \begin{pmatrix}
                h\\
                \alpha\\
            \end{pmatrix}
            .
    $$

Теперь в распоряжении читателя достаточно инструментов, чтобы рассчитать, например, телескоп Галлилея или окуляр. Комбинация нескольких элементов вычисляется как произведение матриц, перечислять их нужно по ходу луча, записывать справа налево (вспомните разговор об алгебре матриц).

Рассчитаем, как должно выглядеть изображение источников в фокальной плоскости тонкой собирающей линзы. Как известно, именно так осуществляется фотофиксация изображений.

Сперва лучи попадают на тонкую линзу с фокусным расстоянием $F$, потом проходят пространство до фокальной плоскости, длина перехода $F$:

$$
    
    \begin{pmatrix}
        h'\\
        \alpha'\\
    \end{pmatrix}
    =
        \begin{pmatrix}
            1&F\\
            0&1\\
        \end{pmatrix}
        
            \begin{pmatrix}
                1&0\\
                -\frac{1}{F}&1\\
            \end{pmatrix}
            
            \begin{pmatrix}
                h\\
                \alpha\\
            \end{pmatrix}
            =
                \begin{pmatrix}
                    0&F\\
                    -\frac{1}{F}&1\\
                \end{pmatrix}
               
                    \begin{pmatrix}
                        h\\
                        \alpha\\
                    \end{pmatrix}
                    =
                        \begin{pmatrix}
                            F\alpha\\
                            \alpha-\frac{h}{F}\\
                        \end{pmatrix}
                        .
    $$

Полученный результат вполне соответствует тому, что обычно возникает в подобных задачах: $h'=F\alpha$ --- часто встречающееся соотношение, справедливость которого не вызывет сомнений. Интересный момент, на который стоит обратить внимание: на конечную высоту луча не влияет высота вхождения луча в систему. С выражением $\alpha'=\alpha-\frac{h}{F}$ тоже всё понятно: результат действия линзы на лучи, прошедшие не через центр линзы, около центра поля зрения поправкой можно пренебречь.

:::{admonition} Задача
:class: tip
Рассчитайте, как преобразует луч классическая схема Галлилея. Используются две  линзы с фокусными расстояниями $F_1, F_2$.
:::
:::{admonition} Задача
:class: tip
Как выглядит матрица для перехода луча из воздуха в среду с показателем преломления $n$? Указание: используйте закон Снелла.
:::

Получим формулу тонкой линзы, пользуясь матричным аппаратом. Оптическая схема состоит из двух трансляций (пустое пространство) и одной линзы:

$$
    
        \begin{pmatrix}
            1&d_1\\
            0&1\\
        \end{pmatrix}
        
        \begin{pmatrix}
            1&0\\
            -\frac{1}{F}&1\\
        \end{pmatrix}
        
        \begin{pmatrix}
            1&d_2\\
            0&1\\
        \end{pmatrix}
        =\begin{pmatrix}
            1&d_1\\
            0&1\\
        \end{pmatrix}
        \begin{pmatrix}
            1&d_2\\
            -\frac{1}{F}&1-\frac{d_2}{F}\\
        \end{pmatrix}
        =
$$
    
$$
    =\begin{pmatrix}
            1-\frac{d_1}{F}&d_1+d_2-\frac{d_1d_2}{F}\\
            -\frac{1}{F}&1-\frac{d_2}{F}\\
        \end{pmatrix}
        .
$$

Поскольку линза тонкая --- высота вышедшего луча не зависит от угла падения. То есть, $d_1+d_2-\frac{d_1d_2}{F}=0$. Выражение тривиально преобразуется в известную формулу: $\frac{1}{d_1}+\frac{1}{d_2}=\frac{1}{F}$.

:::{admonition} Задача
:class: tip
Матрица для сферического зеркала (радиус кривизны $R$) выглядит так:

$$
    
        \begin{pmatrix}
            1&0\\
            \frac{2}{R}&1\\
        \end{pmatrix}
        .
$$
    
Оптический резонатор составляют из двух сферических зеркал с совпадающим центром кривизны. При каких условиях луч продолжительное время не покинет систему?
:::










